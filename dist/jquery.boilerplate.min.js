/*
 *  stick-it - v1.0.0
 *  A jquery plugin for sticky elements.
 *  
 *
 *  Made by Bruno Fenzl
 *  Under MIT License
 */
!function(a,b,c){"use strict";function d(a,b){return function(){return a[b].apply(a,arguments)}}function e(b,c){this.element=b,this.settings=a.extend({},i,c),this._defaults=i,this._name=h,this.settings.parent=this.element.parentElement,this.settings.vendorTransform=f(),this.ticking=!1,this.elGeom=this.getGeomInDocument(this.element),this.parentGeom=this.getGeomInDocument(this.settings.parent),this.dockedTop=!1,this.dockedBottom=!1,this.timer=0,this.transY=0,this.init()}function f(){var a=g();return"Safari"===a.name&&parseInt(a.version)<9||"Chrome"===a.name&&parseInt(a.version)<36||"Opera"===a.name&&parseInt(a.version)<23?"webkitTransform":"MSIE"===a.name&&9===parseInt(a.version)?"msTransform":"transform"}function g(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],{name:"IE",version:a[1]||""}):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!=a)?{name:"Opera",version:a[1]}:(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(a=b.match(/version\/(\d+)/i))&&c.splice(1,1,a[1]),{name:c[0],version:c[1]})}!function(){for(var a=0,c=["ms","moz","webkit","o"],d=0;d<c.length&&!b.requestAnimationFrame;++d)b.requestAnimationFrame=b[c[d]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[c[d]+"CancelAnimationFrame"]||b[c[d]+"CancelRequestAnimationFrame"];b.requestAnimationFrame||(b.requestAnimationFrame=function(c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=b.setTimeout(function(){c(d+e)},e);return a=d+e,f}),b.cancelAnimationFrame||(b.cancelAnimationFrame=function(a){clearTimeout(a)})}();var h="JStick",i={context:b,dockBottom:!0,offsetTop:0,offsetBottom:0};a.extend(e.prototype,{init:function(){console.log("init",this.settings),a(this.settings.context).on("scroll",d(this,"onScroll")),console.log(g().name,g().version)},getPosInViewport:function(a){return(a||this.element).getBoundingClientRect()},getGeomInDocument:function(a){var b=this.getPosInViewport(a),c=this.getScrollOffsets();return{x:b.left+c.x,y:b.top+c.y,w:b.width||b.right-b.left,h:b.height||b.bottom-b.top}},getScrollOffsets:function(a){if(a=a||this.settings.context,null!=a.pageXOffset)return{x:a.pageXOffset,y:a.pageYOffset};var b=a.document;return"CSS1Compat"===c.compatMode?{x:b.documentElement.scrollLeft,y:b.documentElement.scrollTop}:{x:b.body.scrollLeft,y:b.body.scrollTop}},getViewportSize:function(a){if(a=a||this.settings.context,null!=a.innerWidth)return{w:a.innerWidth,h:a.innerHeight};var b=a.document;return"CSS1Compat"===c.compatMode?{w:b.documentElement.clientWidth,h:b.documentElement.clientHeight}:{w:b.body.clientWidth,h:b.body.clientHeight}},dockTop:function(){this.dockedTop=!0,a(this.element).trigger(h+":dockTop")},undockTop:function(){this.element.removeAttribute("style"),this.dockedTop=!1,a(this.element).trigger(h+":undockTop")},dockBottom:function(){this.dockedBottom=!0,a(this.element).trigger(h+":dockBottom")},undockBottom:function(){this.dockedBottom=!1,a(this.element).trigger(h+":undockBottom")},onScroll:function(){this.ticking||requestAnimationFrame(d(this,"loop")),clearTimeout(this.timer),this.timer=setTimeout(function(){this.ticking=!0},100)},loop:function(){this.transY=this.getScrollOffsets().y-this.elGeom.y+this.settings.offsetTop,this.getScrollOffsets().y>=this.elGeom.y-this.settings.offsetTop?this.dockedTop||(this.dockTop(),this.element.style[this.settings.vendorTransform]="translateY("+this.elGeom.y-this.settings.offsetTop+"px)"):this.dockedTop&&this.undockTop(),this.elGeom.y+this.elGeom.h+this.transY>=this.parentGeom.y+this.parentGeom.h?this.dockedBottom||(this.dockBottom(),console.log("new dockbottom"),this.element.style[this.settings.vendorTransform]="translateY("+(this.parentGeom.y+this.parentGeom.h)-(this.elGeom.y+this.elGeom.h)+"px)"):this.dockedBottom&&this.undockBottom(),this.dockedTop&&!this.dockedBottom&&(this.element.style[this.settings.vendorTransform]="translateY("+this.transY+"px)")},destroy:function(){}}),a.fn[h]=function(b){return this.each(function(){a.data(this,"plugin_"+h)||a.data(this,"plugin_"+h,new e(this,b))})}}(jQuery,window,document);